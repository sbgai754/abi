<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Yomitan Compatible Text Output</title>

<style>
/* ================================
   BACKGROUND GITHUB (CUSTOM)
   ================================ */
:root{
  --bg-image-url: url("a7bfa9818992675730304eda95cd377a (1).jpg");
  --content-bg: rgba(255,255,255,0.92);
  --panel-padding: 20px;
  --max-width: 900px;
}

/* FULL PAGE BACKGROUND */
html, body {
  height: 100%;
  margin: 0;
}
body {
  background-image: var(--bg-image-url);
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  font-family: system-ui, Arial;
  color: #111;
}

/* WHITE CONTENT PANEL */
#mainWrap {
  max-width: var(--max-width);
  margin: 25px auto;
  background: var(--content-bg);
  padding: var(--panel-padding);
  border-radius: 14px;
  box-shadow: 0 10px 35px rgba(0,0,0,0.18);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
}

/* =======================================
   TEXTAREA + OUTPUT
   ======================================= */
textarea {
  width: 100%;
  height: 120px;
  font-size: 18px;
  padding: 10px;
  box-sizing: border-box;
  margin-bottom: 10px;
  border-radius: 8px;
  border: 1px solid #ccc;
  background: #fff;
}

#output {
  margin-top: 10px;
  padding: 6px 2px;
  border: none;
  font-size: 20px;
  line-height: 1.45;
  background: transparent;
  white-space: pre-wrap;
  overflow-wrap: break-word;
}

/* =======================================
   BUTTONS
   ======================================= */
.btn {
  padding: 10px 15px;
  font-size: 16px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  margin-right: 10px;
  background:#222;
  color:white;
}

.btn.red { background:#b60000; }

#markBtnInline {
  padding: 10px 12px;
  font-size: 18px;
  border-radius: 8px;
  background:#ffd24d;
  color:#222;
  border:none;
  cursor:pointer;
}

.small { padding:6px 8px; font-size:12px; border-radius:6px; cursor:pointer; }

/* =======================================
   FLOATING BUTTONS
   ======================================= */
#fullscreenBtn {
  position: fixed;
  right: 15px;
  bottom: 15px;
  padding: 14px 18px;
  font-size: 16px;
  border-radius: 50px;
  z-index: 9999;
  background:#222;
  color:white;
  border:none;
  cursor:pointer;
}

/* BLACK ROUND TOGGLE */
#toggleMarksBtn {
  position: fixed;
  left: 15px;
  bottom: 15px;
  width: 54px;
  height: 54px;
  font-size: 24px;
  border-radius: 50%;
  z-index: 9999;
  background:#000;
  color:#fff;
  border:none;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
}

/* =======================================
   BOOKMARK PANEL
   ======================================= */
#marksPreview {
  margin-top: 16px;
  border-top: 1px dashed #dcdcdc;
  padding-top: 12px;
  display:none;
  background: rgba(255,255,255,0.95);
  border-radius: 10px;
  padding: 12px;
}

.marks-header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:8px;
}

.marks-list {
  max-height:220px;
  overflow:auto;
  border:1px solid #ececec;
  padding:8px;
  border-radius:8px;
  background:#fafafa;
}

/* Each bookmark */
.mark-item {
  padding:8px;
  border-radius:6px;
  background:white;
  margin-bottom:8px;
  display:block;
  border: 1px solid #f1f1f1;
}

.mark-meta {
  font-size:11px;
  color:#666;
  margin-bottom:6px;
}

.mark-text {
  font-size:13px;
  white-space:pre-wrap;
  overflow-wrap: break-word;
  word-break: break-word;
}

.mark-actions {
  margin-top:10px;
  display:flex;
  gap:6px;
}

.mark-load { background:#0a74ff; color:white; padding:6px 10px; border-radius:6px; border:none; }
.mark-del  { background:#ff4d4d; color:white; padding:6px 10px; border-radius:6px; border:none; }

/* MOBILE */
@media (max-width:600px){
  #toggleMarksBtn { width:48px; height:48px; font-size:20px; }
}
</style>
</head>
<body>

<div id="mainWrap">

<h2>Web By Fbn Dpe</h2>

<textarea id="input" placeholder="Text nya paste ke sini ya sayang.. >_<"></textarea>

<div class="controls">
  <button class="btn" id="pasteBtn">Paste</button>
  <button class="btn red" id="resetBtn">Reset</button>
  <button id="markBtnInline">★</button>
</div>

<div id="output"></div>

<!-- BOOKMARK PANEL -->
<div id="marksPreview">
  <div class="marks-header">
    <strong id="marksHeaderTitle">Marks (0)</strong>
    <button class="small" id="clearMarksBtn">Clear</button>
  </div>
  <div class="marks-list" id="marksList">
    <div id="noMarksMsg">Belum ada mark.</div>
  </div>
</div>

</div><!--/mainWrap-->

<!-- FLOATING BUTTONS -->
<button id="toggleMarksBtn">★</button>
<button id="fullscreenBtn">⛶</button>

<script>
/* STORAGE KEY */
const KEY = "yomitan_marks_v1";

/* ELEMENTS */
const input = document.getElementById("input");
const output = document.getElementById("output");
const pasteBtn = document.getElementById("pasteBtn");
const resetBtn = document.getElementById("resetBtn");
const markBtnInline = document.getElementById("markBtnInline");
const marksPreview = document.getElementById("marksPreview");
const marksList = document.getElementById("marksList");
const noMarksMsg = document.getElementById("noMarksMsg");
const clearMarksBtn = document.getElementById("clearMarksBtn");
const toggleMarksBtn = document.getElementById("toggleMarksBtn");
const fullscreenBtn = document.getElementById("fullscreenBtn");
const marksHeaderTitle = document.getElementById("marksHeaderTitle");

function nowISO(){ return new Date().toISOString(); }
function niceDate(t){ return new Date(t).toLocaleString(); }
function loadMarks(){ try { return JSON.parse(localStorage.getItem(KEY) || "[]"); } catch(e){ return []; } }
function saveMarks(a){ localStorage.setItem(KEY, JSON.stringify(a)); }

/* ESCAPE HTML */
function escapeHtml(s){
  if (!s) return "";
  return s.replace(/&/g,"&amp;")
          .replace(/</g,"&lt;")
          .replace(/>/g,"&gt;");
}

/* LIVE OUTPUT */
input.addEventListener("input", ()=> output.textContent = input.value );

/* PASTE */
pasteBtn.onclick = async ()=>{
  try{
    const t = await navigator.clipboard.readText();
    input.value = t;
    output.textContent = t;
  }catch{ alert("Clipboard tidak diizinkan."); }
};

/* RESET */
resetBtn.onclick = ()=>{
  input.value = "";
  output.textContent = "";
};

/* ADD MARK - duplicate check */
markBtnInline.onclick = ()=>{
  const text = (input.value || "").trim();
  if (!text) return;

  let arr = loadMarks();

  const normalized = text.replace(/\r\n/g,"\n").trim();
  const idx = arr.findIndex(i => i.text.replace(/\r\n/g,"\n").trim() === normalized);

  if (idx !== -1){
    const old = arr.splice(idx,1)[0];
    old.savedAt = nowISO();
    arr.unshift(old);
  } else {
    arr.unshift({id:Date.now()+"-"+Math.random(), text, savedAt:nowISO()});
  }

  saveMarks(arr);
  renderMarks();
};

/* RENDER MARKS */
function renderMarks(){
  const arr = loadMarks();
  marksHeaderTitle.textContent = `Marks (${arr.length})`;

  marksList.querySelectorAll(".mark-item").forEach(e=>e.remove());

  if (!arr.length){
    noMarksMsg.style.display="block";
    return;
  }
  noMarksMsg.style.display="none";

  arr.forEach(m=>{
    const item = document.createElement("div");
    item.className="mark-item";

    const meta = document.createElement("div");
    meta.className="mark-meta";
    meta.textContent = niceDate(m.savedAt);

    const textDiv = document.createElement("div");
    textDiv.className="mark-text";
    textDiv.innerHTML = escapeHtml(m.text).replace(/\n/g,"<br>");

    const actions = document.createElement("div");
    actions.className="mark-actions";

    const loadBtn = document.createElement("button");
    loadBtn.className="mark-load";
    loadBtn.textContent="Load";
    loadBtn.onclick = ()=>{
      input.value = m.text;
      output.textContent = m.text;
      marksPreview.style.display="none";
    };

    const delBtn = document.createElement("button");
    delBtn.className="mark-del";
    delBtn.textContent="Del";
    delBtn.onclick = ()=>{
      saveMarks(loadMarks().filter(x=>x.id!==m.id));
      renderMarks();
    };

    actions.appendChild(loadBtn);
    actions.appendChild(delBtn);

    item.appendChild(meta);
    item.appendChild(textDiv);
    item.appendChild(actions);

    marksList.appendChild(item);
  });
}

/* CLEAR ALL */
clearMarksBtn.onclick = ()=>{
  if(confirm("Hapus semua mark?")){
    localStorage.removeItem(KEY);
    renderMarks();
  }
};

/* TOGGLE PANEL */
toggleMarksBtn.onclick = ()=>{
  const s = marksPreview.style.display === "block";
  marksPreview.style.display = s ? "none" : "block";
  renderMarks();
};

/* FULLSCREEN */
fullscreenBtn.onclick = ()=>{
  if (!document.fullscreenElement){
    document.documentElement.requestFullscreen();
    fullscreenBtn.textContent="×";
  } else {
    document.exitFullscreen();
    fullscreenBtn.textContent="⛶";
  }
};

/* INIT */
renderMarks();
</script>

</body>
</html>
